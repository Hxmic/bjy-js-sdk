<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>聊天列表</title>
    <link rel="stylesheet" href="http://live-cdn.baijiacloud.com/js-sdk/0.0.225/message/MessageList.css">
    <style>

        #message-list {
            width: 300px;
            height: 600px;
            background-color: #FFF;
            position: relative;
        }

        .bjy-avatar {
            border-radius: 50%;
        }

        .bjy-number {
            display: none !important;
        }

    </style>
</head>
<body>

    <div id="message-list">
        <div class="placeholder">

        </div>
    </div>

    <script src="http://cdn.bootcss.com/jquery/1.12.4/jquery.js"></script>
    <script src="http://live-cdn.baijiacloud.com/js-sdk/0.0.225/classroom/classroom.js"></script>
    <script src="http://live-cdn.baijiacloud.com/js-sdk/0.0.225/message/MessageList.js"></script>
    <script>

        BJY.init({
            env: 'test',
            class: {
                id: '17022337154216',
                name: '课程名称',
                startTime: 1489104000000,
                endTime: 1489190400000
            },
            user: {
                number: '44853061',
                avatar: 'http://img.gsxservice.com/30517_djgkb6i6.jpeg',
                name: 'asd',
                type: 0
            }
        });

        var config = BJY.config;
        var eventEmitter = BJY.eventEmitter;

        eventEmitter
        .one(
            eventEmitter.VIEW_RENDER_TRIGGER,
            function (event, data) {
                var userRoleMap = { };
                userRoleMap[ config.ROLE_TYPE_TEACHER ] = {
                    en: 'teacher',
                    cn: '老师'
                };
                userRoleMap[ config.ROLE_TYPE_ASSISTANT ] = {
                    en: 'assistant',
                    cn: '助教'
                };
                userRoleMap[ config.ROLE_TYPE_STUDENT ] = {
                    en: 'student',
                    cn: '学生'
                };
                userRoleMap[ config.ROLE_TYPE_GUEST ] = {
                    en: 'guest',
                    cn: '游客'
                };
                BJY.MessageList.create({
                    channel: 'chat',
                    element: $('#message-list .placeholder'),
                    renderEmoji: function (name, url) {
                        return '<img ondragstart="return false" src="'
                                + (url + '@100w_1e_1l')
                                + '" srcset="'
                                + (url + '@200w_1e_1l')
                                + ' 2x">';
                    },
                    renderImage: function (url) {
                        if (BJY.isAlicloudImage(url)) {
                            return '<img ondragstart="return false" src="'
                                + (url + '@100w_1e_1l')
                                + '" srcset="'
                                + (url + '@200w_1e_1l')
                                + ' 2x">';
                        }
                        return '<img ondragstart="return false" src="' + url + '">';
                    },
                    renderUser: function (user, width, height) {
                        return {
                            id: user.id,
                            name: user.name,
                            number: user.number,
                            // 头像需压缩
                            avatar1x: BJY.compressImage({
                                url: user.avatar,
                                width: width,
                                height: height
                            }),
                            avatar2x: BJY.compressImage({
                                url: user.avatar,
                                width: width * 2,
                                height: height * 2
                            }),
                            // 根据用户类型，配置角色的英文和本地语言
                            role: userRoleMap[user.type].en,
                            localRole: userRoleMap[user.type].cn,
                        }
                    }
                });
            }
        );


    </script>
</body>
</html>
