<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>教室</title>
</head>
<body>

    <script src="http://cdn.bootcss.com/jquery/1.12.4/jquery.js"></script>
    <script src="http://live-cdn.baijiacloud.com/js-sdk/0.0.265/classroom/classroom.js"></script>
    <script>

        BJY.init({
            env: 'production',
            sign: '539ea893e5835e46ee0707c89d7554e9',
            class: {
                id: '17022883512665',
                name: '课程名称',
                startTime: 1489104000000,
                endTime: 1489190400000
            },
            // 当前用户配置
            // type 0 表示学生，1 表示老师
            user: {
                number: '40721586',
                avatar: 'http://static.sunlands.com/newUserImagePath/40721586/40_40/40721586.jpg',
                name: '当前用户昵称',
                type: 0
            },
            // 如果知道此教室对应的老师信息，可传入，否则可不传
            teacher: {
                number: '12312312312',
                avatar: 'http://img.gsxservice.com/30517_djgkb6i6.jpeg',
                name: '老师昵称',
                type: 1
            }
        });

        var eventEmitter = BJY.eventEmitter;

        console.log('初始化进度条视图');

        eventEmitter
        .one(
            eventEmitter.MASTER_SERVER_CONNECT_SUCCESS,
            function () {
                console.log('MASTER_SERVER_CONNECT_SUCCESS');
                console.log('进度条走到 20%');
            }
        )
        .one(
            eventEmitter.SERVER_INFO_FETCH_SUCCESS,
            function () {
                console.log('SERVER_INFO_FETCH_SUCCESS');
                console.log('进度条走到 40%');
            }
        )
        .one(
            eventEmitter.ROOM_SERVER_CONNECT_SUCCESS,
            function () {
                console.log('ROOM_SERVER_CONNECT_SUCCESS');
                console.log('进度条走到 60%');
            }
        )
        .one(
            eventEmitter.ROOM_SERVER_LOGIN_SUCCESS,
            function () {
                console.log('ROOM_SERVER_LOGIN_SUCCESS');
                console.log('进度条走到 80%');
                // 到这里已经成功登录，进度条用动画过渡到 100% 即可
            }
        )
        .one(
            eventEmitter.VIEW_RENDER_TRIGGER,
            function (event, data) {
                // 如果是 PC 网页，需检测 flash 的支持情况
                if (!BJY.support.flash) {
                    alert('请安装 flash');
                }
                // 在此初始化业务视图
                console.log('渲染业务视图');
            }
        )
        .on(
            eventEmitter.CLASSROOM_CONNECT_START,
            function (event, data) {
                if (data.reconnect) {
                    console.log('正在重连');
                }
            }
        )
        .on(
            eventEmitter.CLASSROOM_CONNECT_END,
            function (event, data) {
                if (data.reconnect) {
                    console.log('重连结束');
                }
            }
        );

    </script>
</body>
</html>
